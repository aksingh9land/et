<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title></title>
  <meta name="author" content="Shan Carter">
  <link rel="stylesheet" href="css/converter.css" type="text/css" media="screen" title="no title" charset="utf-8">

  <script src="js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/CSVParser.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/DataGridRenderer.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/converter.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/Controller.js" type="text/javascript" charset="utf-8"></script>

</head>
<body>
  <div id='base'>
    <div id='header'>
      <div id="description">
        <h1>Tally XML Converter</h1>
        <p>You can use Excel,Text,CSV etc file. Columns should be same as Templates.</p>
        <p>Paste Data-Choose XML Type-Click on Create File and Download.</p>
        <p>Paste XML file path in Tally Import to Create Entry.</p>
        <p>Mo.No - +91- 9131810293, Email: Learnwells@outlook.com, Web:www.Learnwells.com</p>
        <p>Click for Learning Videos <a href="https://www.youtube.com/learnwell/c">LEARNWELL</a>.</p>
      </div>
      <div id='settings'>
        <h3></h3>
        <form id='settingsForm'>
           

        <p><label><input class="settingsElement" type="radio" name="delimiter" id='delimiterAuto'   value="auto" checked/> </label>


             <label><input class="settingsElement" type="radio" name="decimal" id='decimalDot'   value="dot" checked/></label>

          
          <label><input class="settingsElement" type="checkbox" name="" value="" id="headersProvidedCB" checked /></label>
          <div class="settingsGroup">
         
            <label><input class="settingsElement" type="radio" name="headerModifications" id='headersNoTransform' value="none" checked /></label>
          </div>

          <label><input class="settingsElement" type="checkbox" name="some_name" value="" id="includeWhiteSpaceCB" checked /></label>
          <div class="settingsGroup">
            <label><input class="settingsElement" type="radio" name="indentType" value="spaces" id='includeWhiteSpaceSpaces' checked/></label></p>
          </div>


        </form>


      </div>
    </div>



    <div id='converter' class=''>

    </div>

  </div>
<section>
  <div id="container">
    <input type="text" value="MyFile.xml" placeholder="filename.xml">
    <button onclick="downloadFile()">Create file</button> <output></output>
    <aside id="download-help">
    </aside>
  </div>
</section>

<script>
var container = document.querySelector('#container');
// Shakti commented below line
//var typer = container.querySelector('[contenteditable]');
var output = container.querySelector('output');

const MIME_TYPE = 'text/plain';

// Rockstars use event delegation!
document.body.addEventListener('dragstart', function(e) {
  var a = e.target;
  if (a.classList.contains('dragout')) {
    e.dataTransfer.setData('DownloadURL', a.dataset.downloadurl);
  }
}, false);

document.body.addEventListener('dragend', function(e) {
  var a = e.target;
  if (a.classList.contains('dragout')) {
    cleanUp(a);
  }
}, false);

document.addEventListener('keydown', function(e) {
  if (e.keyCode == 27) {  // Esc
    document.querySelector('details').open = false;
  } else if (e.shiftKey && e.keyCode == 191) { // shift + ?
    document.querySelector('details').open = true;
  }
}, false);

var cleanUp = function(a) {
  a.textContent = 'Downloaded';
  a.dataset.disabled = true;

  // Need a small delay for the revokeObjectURL to work properly.
  setTimeout(function() {
    window.URL.revokeObjectURL(a.href);
  }, 1500);
};

var downloadFile = function() {
  window.URL = window.webkitURL || window.URL;

  var prevLink = output.querySelector('a');
  if (prevLink) {
    window.URL.revokeObjectURL(prevLink.href);
    output.innerHTML = '';
  }
  
  // Shakti added below line.
var typer = document.getElementById("dataOutput");

  var bb = new Blob([typer.value], {type: MIME_TYPE}); // Shakti replaced typer.textContent from  typer.value

  var a = document.createElement('a');
  a.download = container.querySelector('input[type="text"]').value;
  a.href = window.URL.createObjectURL(bb);
  a.textContent = 'Download ready';

  a.dataset.downloadurl = [MIME_TYPE, a.download, a.href].join(':');
  a.draggable = true; // Don't really need, but good practice.
  a.classList.add('dragout');

  output.appendChild(a);

  a.onclick = function(e) {
    if ('disabled' in this.dataset) {
      return false;
    }

    cleanUp(this);
  };
};
</script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22014378-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</body>
</html>
